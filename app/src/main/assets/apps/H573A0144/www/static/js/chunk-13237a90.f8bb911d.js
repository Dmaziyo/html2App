(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13237a90"],{"05b0":function(t,e,i){t.exports=i.p+"static/img/bg_1.aecbdc9b.jpg"},"1a26":function(t,e,i){"use strict";i("c7d1")},"1e01":function(t,e,i){},2262:function(t,e,i){t.exports=i.p+"static/img/player_cover.373e0739.png"},"3dc6":function(t,e,i){},"8eb0":function(t,e,i){"use strict";i("bd49")},a073:function(t,e,i){},a7a7:function(t,e,i){"use strict";i("a073")},acef:function(t,e,i){"use strict";i("3dc6")},b76b:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music"},[i("div",{staticClass:"music-content"},[i("div",{staticClass:"music-left"},[i("music-btn"),i("keep-alive",[t.$route.meta.keepAlive?i("router-view",{staticClass:"music-list"}):t._e()],1),t.$route.meta.keepAlive?t._e():i("router-view",{staticClass:"music-list"})],1),i("div",{staticClass:"music-right"},[i("lyric",{ref:"lyric",attrs:{lyric:t.lyric,nolyric:t.nolyric,"lyric-index":t.lyricIndex,currentMusic:t.currentMusic}})],1)]),i("div",{staticClass:"music-bar",class:{disable:!t.musicReady||!t.currentMusic.id}},[i("div",{staticClass:"music-bar-btns"},[i("mz-icon",{staticClass:"pointer",attrs:{title:"上一首 Ctrl+Left",type:"prev",size:36},on:{click:t.prev}}),i("div",{staticClass:"control-play pointer",attrs:{title:"播放暂停 Ctrl+Space"}},[i("mz-icon",{attrs:{type:t.playing?"pause":"play",size:24},on:{click:t.play}})],1),i("mz-icon",{staticClass:"pointer",attrs:{type:"next",size:36,title:"下一首 Ctrl + Right"},on:{click:t.next}})],1),i("div",{staticClass:"music-music"},[i("div",{staticClass:"music-bar-info"},[t.currentMusic&&t.currentMusic.id?[t._v(" "+t._s(t.currentMusic.name)+" "),i("span",[t._v("-"+t._s(t.currentMusic.singer))])]:[t._v("欢迎使用MaZiYo在线播放器")]],2),i("div",{staticClass:"music-bar-time"},[t._v(t._s(t._f("format")(t.currentTime))+"/"+t._s(t._f("format")(t.currentMusic.duration%3600)))]),i("mz-progress",{staticClass:"music-progress",attrs:{percent:t.percentMusic,"percent-progress":t.currentProgress},on:{"percent-change-end":t.progressMusicEnd,"percent-change":t.progressMusic}})],1),i("mz-icon",{staticClass:"pointer mode",attrs:{type:t.ModeIconType,title:t.ModeIconTitle,size:30},on:{click:t.modeChange}}),i("mz-icon",{staticClass:"pointer comment",attrs:{type:"comment",size:30}}),i("div",{staticClass:"music-bar-volume",attrs:{title:"音量加减[Ctrl+Up/Down]"}},[i("volume",{attrs:{volume:t.volume},on:{"volume-change":t.volumeChange}})],1)],1),i("div",{staticClass:"mzPlayer-bg",style:{"background-image":t.backgroundUrl}}),i("div",{staticClass:"mzPlayer-mask"})])},n=[],r=i("ade3"),c=i("5530"),o={initAudio:function(t){var e=t.audioEle;e.onprogress=function(){try{if(e.buffered.length>0){var i=t.currentMusic.duration,s=0;s=e.buffered(0)>=i?i:e.buffered.end(0),t.currentProgress=s/i}}catch(n){console.log(n)}},e.onplay=function(){var e;clearTimeout(e),e=setTimeout((function(){t.musicReady=!0}),100)},e.ontimeupdate=function(){t.currentTime=e.currentTime},e.oncanplay=function(){0!==t.historyList.length&&t.currentMusic.id===t.historyList[0].id||t.setHistory(t.currentMusic)}}},u=o,a=i("ca00"),l=i("5d2d"),m=i("365c"),d=i("f57b"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"mzProgress",staticClass:"mzProgress",on:{click:t.barClick}},[i("div",{staticClass:"mzProgress-bar"},[i("div",{ref:"mzPercentProgress",staticClass:"mzProgress-outer"}),i("div",{ref:"mzProgressInner",staticClass:"mzProgress-inner"},[i("div",{staticClass:"mzProgress-dot",on:{mousedown:t.barDown}})])])])},p=[],f=(i("a9e3"),10),v={name:"MzProgress",props:{percent:{type:Number,default:0},percentProgress:{type:Number,default:0}},watch:{percent:function(t){if(t>=0&&!this.move.status){var e=this.$refs.mzProgress.clientWidth-f,i=t*e;this.moveSlide(i)}},percentProgress:function(t){var e=this.$refs.mmProgress.clientWidth-f,i=e*t;this.$refs.mzPercentProgress.style.width="".concat(i,"px")}},data:function(){return{move:{status:!1,startX:0,left:0}}},mounted:function(){var t=this;this.$nextTick((function(){t.bindEvents();var e=t.$refs.mzProgress.clientWidth-f,i=t.percent*e;t.moveSlide(i)}))},beforeDestroy:function(){this.unbindEvents()},methods:{bindEvents:function(){document.addEventListener("mousemove",this.barMove),document.addEventListener("mouseup",this.barUp)},unbindEvents:function(){document.removeEventListener("mousemove",this.barMove),document.removeEventListener("mouseup",this.barUp)},barDown:function(t){this.move.status=!0,this.move.startX=t.clientX,this.move.left=this.$refs.mzProgressInner.clientWidth},barMove:function(t){if(!this.move.status)return!1;t.preventDefault();var e=t.clientX,i=e-this.move.startX,s=Math.min(this.$refs.mzProgress.clientWidth-f,Math.max(0,this.move.left+i));this.moveSlide(s),this.commitPercent()},barUp:function(){this.move.status&&(this.commitPercent(!0),this.move.status=!1)},moveSlide:function(t){this.$refs.mzProgressInner.style.width="".concat(t,"px")},barClick:function(t){var e=this.$refs.mzProgress.getBoundingClientRect(),i=Math.min(this.$refs.mzProgress.clientWidth-f,Math.max(0,t.clientX-e.left));this.moveSlide(i),this.commitPercent(!0)},commitPercent:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.$refs,i=e.mzProgress,s=e.mzProgressInner,n=i.clientWidth-f,r=s.clientWidth/n;this.$emit(t?"percent-change-end":"percent-change",r)}}},g=v,y=(i("8eb0"),i("2877")),b=Object(y["a"])(g,h,p,!1,null,null,null),C=b.exports,M=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music-btn"},[i("router-link",{attrs:{to:"/music/playlist",tag:"span"}},[t._v("正在播放")]),i("router-link",{attrs:{to:"#",tag:"span"}},[t._v("推荐")]),i("router-link",{attrs:{to:"/music/search",tag:"span"}},[t._v("搜索")]),i("router-link",{attrs:{to:"#",tag:"span"}},[t._v("我的歌单")]),i("span",{staticClass:"show_960",on:{click:function(e){return t.$emit("onClickLyric")}}},[t._v("歌词")]),i("router-link",{attrs:{to:"/music/historylist",tag:"span"}},[t._v("我听过的")])],1)},_=[],z={},P=z,x=(i("a7a7"),Object(y["a"])(P,M,_,!1,null,"7b73207c",null)),T=x.exports,k=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("dl",{staticClass:"music-info"},[i("dt",[i("img",{attrs:{src:t.musicPicUrl}})]),t.currentMusic.id?[i("dd",[t._v("歌曲名:"+t._s(t.currentMusic.name))]),i("dd",[t._v("歌手名:"+t._s(t.currentMusic.singer))]),i("dd",[t._v("专辑名:"+t._s(t.currentMusic.album))])]:[i("dd",[t._v("MaZiYo在线音乐播放器")]),i("dd",[i("a",{staticClass:"hover",attrs:{href:"https://github.com/Dmaziyo",target:"blank"}},[i("mz-icon",{attrs:{type:"github",size:14}}),t._v(" D城兔MaZiYo ")],1)])],i("div",{ref:"musicLyric",staticClass:"music-lyric"},[i("div",{staticClass:"music-lyric-items",style:t.lyricTop},[t.currentMusic.id?t._e():i("p",[t._v("还没有播放音乐哦!")]),t.nolyric?i("p",[t._v("暂无歌词!")]):t.lyric.length>0?t._l(t.lyric,(function(e,s){return i("p",{key:s,class:{on:t.lyricIndex===s}},[t._v(t._s(e.text))])})):i("p",[t._v("歌词加载失败!")])],2)])],2)])},I=[],j=i("2f62"),E={props:{lyric:{type:Array,default:function(){return[]}},nolyric:{type:Boolean,default:!1},lyricIndex:{type:Number,default:0}},components:{MzIcon:d["a"]},data:function(){return{top:0}},computed:Object(c["a"])({musicPicUrl:function(){return this.currentMusic.id?"".concat(this.currentMusic.image,"?param=300y300"):i("2262")},lyricTop:function(){return"transform:translate3d(0,".concat(-34*(this.lyricIndex-this.top),"px,0)")}},Object(j["c"])(["currentMusic"])),mounted:function(){var t=this;window.addEventListener("resize",(function(){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout((function(){t.calcTop()}),60)})),this.$nextTick((function(){t.calcTop()}))},methods:{calcTop:function(){var t=this.$refs.musicLyric,e=window.getComputedStyle(t),i=e.display,s=void 0===i?"":i;if("none"!==s){var n=t.offsetHeight;this.top=Math.floor(n/34/2)}}}},O=E,$=(i("acef"),Object(y["a"])(O,k,I,!1,null,null,null)),L=$.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"volume"},[i("mz-icon",{staticClass:"pointer volume-icon",attrs:{type:t.getVolumeIconType,size:30},on:{click:t.handleToggleVolume}}),i("div",{staticClass:"volume-progress-wrapper"},[i("mz-progress",{attrs:{percent:t.volume},on:{"percent-change-end":t.handleVolumeChange,"percent-change":t.handleVolumeChange}})],1)],1)},S=[],R={components:{MzProgress:C,MzIcon:d["a"]},props:{volume:{type:Number,required:!0}},computed:{isMute:{get:function(){return 0===this.volume},set:function(t){var e=t?0:this.lastVolume;t&&(this.lastVolume=this.volume),this.handleVolumeChange(e)}},getVolumeIconType:function(){return this.isMute?"volume-off":"volume"}},methods:{handleVolumeChange:function(t){this.$emit("volume-change",t)},handleToggleVolume:function(){this.isMute=!this.isMute}}},V=R,U=(i("d18c"),Object(y["a"])(V,w,S,!1,null,"715e72b8",null)),D=U.exports,N=i("db49"),W={components:{MzIcon:d["a"],MzProgress:C,MusicBtn:T,Lyric:L,Volume:D},data:function(){var t=Object(l["d"])();return{lyric:[],nolyric:!1,lyricIndex:0,musicReady:!1,currentTime:0,currentProgress:0,mode:1,volume:t}},filters:{format:a["a"]},computed:Object(c["a"])({percentMusic:function(){var t=this.currentMusic.duration;return this.currentTime&&t?this.currentTime/t:0},backgroundUrl:function(){return console.log("1"),this.currentMusic.id?"url(".concat(this.currentMusic.image,")"):"url("+i("05b0")+")"},ModeIconType:function(){var t;return(t={},Object(r["a"])(t,N["d"].listLoop,"loop"),Object(r["a"])(t,N["d"].order,"sequence"),Object(r["a"])(t,N["d"].random,"random"),Object(r["a"])(t,N["d"].loop,"loop-one"),t)[this.mode]},ModeIconTitle:function(){var t,e="Ctrl+O";return(t={},Object(r["a"])(t,N["d"].listLoop,"列表循环".concat(e)),Object(r["a"])(t,N["d"].order,"顺序播放".concat(e)),Object(r["a"])(t,N["d"].random,"随机播放".concat(e)),Object(r["a"])(t,N["d"].loop,"单曲循环".concat(e)),t)[this.mode]}},Object(j["c"])(["audioEle","currentIndex","currentMusic","playList","playing","historyList"])),watch:Object(c["a"])({currentMusic:function(t,e){var i=this;t.id?t.id!==e.id&&(this.audioEle.src=t.url,this.audioEle.play(),this.$nextTick((function(){i._getLyric(t.id)})),this.lyricIndex=this.currentTime=this.currentProgress=0):this.lyric=[]},playing:function(t){var e=this,i=this.audioEle;this.$nextTick((function(){t?i.play().then(null,(function(){})):i.pause(),e.musicReady=!0}))},currentTime:function(t){if(!this.nolyric){for(var e=0,i=0;i<this.lyric.length;i++)t>this.lyric[i].time&&(e=i);this.lyricIndex=e}}},Object(j["b"])(["setHistory"])),mounted:function(){var t=this;this.$nextTick((function(){u.initAudio(t)}))},methods:Object(c["a"])(Object(c["a"])({prev:function(){if(this.musicReady){var t=this.currentIndex-1>=0?this.currentIndex-1:this.playList.length-1;this.setCurrentIndex(t)}},play:function(){this.musicReady&&this.setPlaying(!this.playing)},next:function(){if(this.musicReady){var t=this.currentIndex+1<this.playList.length?this.currentIndex+1:0;this.setCurrentIndex(t)}},_getLyric:function(t){var e=this;Object(m["a"])(t).then((function(t){t.nolyric?e.nolyric=!0:(e.nolyric=!1,e.lyric=Object(a["b"])(t.lrc.lyric)),e.audioEle.play()}))},modeChange:function(){var t=(this.mode+1)%4;this.mode=t},progressMusic:function(t){this.currentTime=this.currentMusic.duration*t},progressMusicEnd:function(t){this.audioEle.currentTime=this.currentMusic.duration*t},volumeChange:function(t){this.volume=t,this.audioEle.volume=t,Object(l["g"])(t)}},Object(j["d"])({setPlaying:"SET_PLAYING",setPlayList:"SET_PLAYLIST",setCurrentIndex:"SET_CURRENTINDEX"})),Object(j["b"])(["setHistory"]))},A=W,X=(i("1a26"),Object(y["a"])(A,s,n,!1,null,null,null));e["default"]=X.exports},bd49:function(t,e,i){},c7d1:function(t,e,i){},d18c:function(t,e,i){"use strict";i("1e01")},f57b:function(t,e,i){"use strict";i("a9e3");var s,n,r={name:"MzIcon",props:{type:{type:String,required:!0},size:{type:Number,default:16}},methods:{getIconCls:function(){return"icon-".concat(this.type)},getIconStyle:function(){return{fontSize:this.size+"px"}},onClick:function(t){this.$emit("click",t)}},render:function(t){return t("i",{style:this.getIconStyle(),class:"iconfont ".concat(this.getIconCls()),on:{click:this.onClick}})}},c=r,o=i("2877"),u=Object(o["a"])(c,s,n,!1,null,null,null);e["a"]=u.exports}}]);
//# sourceMappingURL=chunk-13237a90.f8bb911d.js.map